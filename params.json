{"name":"Lockwatcher","tagline":"Anti-forensic monitor program: watches for signs of forensic aquisition and purges keys/shuts everything down.","body":"lockwatcher\r\n===========\r\n\r\nAnti live-forensics monitor program: watches for signs of tampering or forensic acquisition, purges encryption keys and shuts \r\neverything down.\r\n\r\nIt was thought up when writing a proof of concept for defeating live forensic analysis as part of a masters thesis\r\n that evaluated anti-forensic techniques.\r\n \r\nWhy?\r\n=====\r\nOperating systems have improved physical security over recent years (eg: by not allowing auto-run when \r\nthe screen is locked) but even if they ignore a CD being inserted into the drive while the computer is locked, they\r\n are still sitting there happily allowing someone to keep trying to get your data. \r\n \r\n This is bad. \r\n \r\n lockwatcher is built around the assumption that if someone tries to use your computer while it is locked\r\n then they are trying to get your live data, so it needs to be destroyed.\r\n \r\n*How lockwatcher works*\r\n \r\n* You lock computer whenever not physically present at it.\r\n \r\n* \"Interaction\" with the computer while locked triggers an emergency shutdown.\r\n \r\n* Encryption keys are purged from memory and the computer shuts down to help prevent live data from being acquired.\r\n\r\nCaveats:\r\n==========\r\nThe software was designed for running on live-CD/live-USB Linux, where dismounting (deniably) encrypted storage and \r\npowering down is accomplished in 3-5 seconds or less, with little warning given to the attacker. \r\n \r\nThere is a Windows version but even forced shutdown is SLOW and obvious, and the difficulty in running it \r\nfrom ramdisk (live-USB,etc) means you are likely to have lots of interesting things on disk even if they can't \r\nget your RAM out in time.\r\n \r\nIt is specifically designed for defeating live memory acquisition.\r\n\r\nIt does not protect against disk analysis. That is what encryption is for, but lockwatcher will help keep your\r\nkeys safe.\r\n\r\nIt does not stop malicious software from stealing your data. Good information security practice will help, running \r\na live distribution from read-only media will help and doing your sensitive stuff on a computer that does not \r\ntalk to the internet will help but this is a big problem.\r\n\r\nIt offers very little protection from surveillance. Although it can be configured to save (or email) a photo of\r\nan intruder in the room, this isn't an insurmountable obstacle to someone who wants to use cameras, microphones, \r\nRF monitoring equipment and so on.\r\n\r\nIt does not protect you from having someone beat you with a wrench (or threaten prison time) to get your \r\nencryption keys. Deniable encryption might help, but using it effectively requires a lot of diligence.\r\n\r\nThere can be false positives. A device failing or a cat walking around the room can scare the system into \r\nshutting down. By default a shutdown isn't very destructive, so this should only be a nuisance if it happens.\r\n\r\n*What kind of 'Interaction' are we talking about?\r\n=============\r\nThere are lots of triggers for an emergency shutdown which can be tailored for the environment \r\nthe computer is running in.\r\n\r\n* Device monitoring\r\n\r\nAny devices or disks being plugged into the system or removed. USB, Firewire, CDs, etc.\r\n\r\n* Keyboard kill-switch\r\n\r\nOne or more keyboard keys can be set to trigger an emergency shutdown if you are at the computer when it is required.\r\n\r\n* Network interface monitoring\r\n\r\nIf the standard procedure of isolating the computer from the network is followed, or an attacker connects/disconnects\r\na network interface to access traffic then lockwatcher will notice this and trigger a shutdown.\r\n\r\n* Bluetooth monitoring\r\n\r\nlockwatcher can connect to a Bluetooth device and trigger a shutdown if this connection is severed. This is useful \r\nif your devices are removed, turned off or placed in a shielded container by an attacker. If you have a device which\r\n can be quickly turned off or parted from its batteries then this becomes a handy portable kill-switch when you are \r\n not at the computer.\r\n \r\n* RAM temperature detection\r\n\r\nThe first defence against RAM acquisition by freezing/removing memory modules \r\n(see: https://citp.princeton.edu/research/memory/), Lockwatcher can monitor the temperature of certain memory \r\nmodules and trigger if their temperature falls below a certain point.\r\n\r\nThe availability of memory modules with temperature sensors is bad so at the moment lockwatcher only\r\nsupports monitoring Crucial Ballistix modules, and only on Windows (requires installing the Ballistix MOD utility).\r\nAnyone who would like to contribute code to read temperature directly and from other types of RAM (like \r\nHWMonitor does) would be appreciated.\r\n\r\n* Chassis movement detection\r\n\r\nA much better defence against RAM acquisition, but fiddly to set up and requires some hardware.\r\n\r\nYou need a webcam. A Â£5 no-brand horror will be fine but one without a microphone or a microphone you have \r\ndisabled would be a good idea for obvious reasons. The camera or inside of your case should also have an LED or two \r\nto give the case a bit of light inside.\r\n\r\nNow the tricky bit: Suspend it in the computer case so it can swing freely. Use tape, string, whatever: just make sure\r\n the camera is free to swing a little when the case itself is moved. It also needs to be plugged in to USB, \r\n preferably to an internal USB port.\r\n \r\n ![It is easier if your case is not cable-managment hell](casepicture1.jpg)\r\n \r\nIf the case is securely shut (preferably with a lock) then any movement of the case or attempts to open it up will\r\n either move the camera or change the lighting conditions in the chassis, triggering a shutdown long before the\r\n RAM or BIOS can be tampered with. This also helps prevent hot-plug attacks against self-encrypting hard drives.\r\n\r\nThis trigger (and the one below) requires some free motion detection software: motion on Linux, iSpy on Windows. \r\n\r\n* Room movement detection\r\n\r\nA camera can be pointed at the room to shut down when any motion is detected. Not too useful if pets/family/coworkers\r\n are expected to be in the same room as the computer while you are away.\r\n \r\nThis trigger can be activated and deactivated remotely so the system doesn't shutdown \r\nwhenever you return to the computer. \r\n\r\nThis also allows a photo to be saved or emailed to alert you to the identity of the attacker.\r\n\r\n* Not yet implemented - Intrusion switch monitoring\r\n\r\nTrigger a shutdown if the case is opened and the motherboard intrusion detection switch is activated. \r\n\r\n* Not yet implemented - Power supply monitoring\r\n\r\nThe room motion trigger could in theory be circumvented by cutting power to the room and then taking the memory\r\n modules. If the case is reasonably secure then there is minimal chance of this being successful, but a transition \r\n from mains power to uninterruptable power supply could be used as a trigger. And cause false positives in a \r\n power outage.\r\n\r\nBonus points\r\n===============\r\nAnything that increases the time between trigger activation and having your memory ripped out is helpful. Keep your system chassis secure, and tucked away so that doing anything with it requires moving it around and setting off the chassis motion monitor.\r\n\r\nPassword protect your BIOS to stop someone rebooting straight into a memory analysis CD. \r\n\r\nIf your BIOS can be configured to perform a complete memory check on start up, (or even better to wipe memory) then activate those options. Yes it will require a password every time your system boots up and slow the process down, but some level of inconvenience has to be accepted.\r\n\r\nNot important, but If your cables allow it you can swap the reset and power switch pins on the motherboard. An attempt to use the reset button to do a hard reset will trigger a standard shutdown instead, which causes Truecrypt to dismount its volumes. \r\n\r\nLinux Installation\r\n================\r\nThese packages are required\r\n* sudo apt-get install motion ifplugd lm-sensors \r\n\r\n* Install Imapclient (https://pypi.python.org/pypi/IMAPClient/0.10.2) by whatever method is convenient \r\n\r\n* [download/unzip lockwatcher]\r\n\r\nInitial configuration:\r\n* sudo setupfiles/setup.sh\r\n\r\nTo configure further via GUI:\r\n* sudo src/lockwatcher-gui/lockwatcher-gui.py\r\n\r\n![Configure further via the GUI](guipicture.png)\r\n\r\nsudo src/lockwatcher.py start\r\n\r\n\r\nWindows Installation\r\n================\r\n*The free, open-source iSpy software is required for room and chassis motion detection\r\n\r\nGet it here: http://www.ispyconnect.com/download.aspx\r\nInstall it, configure your cameras (covered later).\r\n\r\n* Install lockwatcher from the msi, or just extract the .zip somewhere\r\n* Run lockwatcher.exe, play with the settings\r\n* Click 'Start lockwatcher' on the status panel\r\n\r\nUsing remote control\r\n====================\r\n(I know this is a pain in the neck, hopefully a native app will be up and running for iOS and Android at some point)\r\nYou need an email account with smtp and imap access, preferably a throwaway account that you don't use for anything else.\r\n\r\n* Install QPython on your Android device\r\n\r\n* Go to http://qpython.com/create.php, paste in the mobilecontrol.py code\r\n\r\n* Edit emails,password to your liking and add the authentication secret from the Lockwatcher email settings tab\r\n\r\n* Generate the QRCode on the web page, scan it with QPython on your phone\r\n\r\n* Save it as a script\r\n \r\n* Whenever you want to use it, open QPython and execute the script\r\n\r\n![The mobile control interface](mcpicture.png)\r\n\r\nQ&A\r\n============\r\nQ.Can lockwatcher wipe files instead of just shutting down? \r\n\r\nA.You can add relevant commands to the custom batch script which will be executed on emergency shutdown, but it takes a long time and makes false positive triggers a much bigger problem.\r\n\r\nQ.Curse you authoritarian pigdog fascist, I want to use your stuff but it is riddled with government backdoors!\r\n\r\nA. You can go through the source code if you want, most of it is written in Python 3 so it isn't even \r\ncompiled on Linux. The lack of Windows access to Bluetooth sockets (with Python 3, try it if you don't believe me) \r\nand user defined Signals means a bit of C code is in the Win32 distribution as little executables, \r\nwhich is what Avast flags as suspicious occasionally. They are easy to compile with cygwin.\r\n\r\nQ.When is the Mac version coming out?\r\n\r\nA.Either when someone else writes one or when someone buys me a Mac to develop/test it on.\r\n\r\nTo-do list\r\n===========\r\n* Write iOS/Android apps instead of doing the qpython thing\r\n\r\n* RAM temperature monitoring on Linux. My motherboard won't play nice with decode-dimms and \r\nI haven't had much luck doing what the ballistix MOD utility does. \r\nAlso: other types of RAM on both operating systems.\r\n\r\n* Testing and better install configurations for other linux distros\r\n\r\n* I'm not happy with the Windows shutdown speed at all, it might be worth implementing RAM erasing instead.\r\nI can't get firewire attacks to work on Window 7 so whether the shutdown process interrupts \r\nRAM acquisition in time or not is a mystery.\r\n\r\n* If anyone could write something like this for Android/iOS/etc then please do. The exposure of mobile devices to \r\nseizure and acquisition at borders or on arrest, plus their critical reliance on a tiny stable of acquisition tools\r\n makes them the most deserving hosts of this kind of tool. Storage wiping would even be handy, but I don't know \r\nif it can be done without jailbreaking at the very least.\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}